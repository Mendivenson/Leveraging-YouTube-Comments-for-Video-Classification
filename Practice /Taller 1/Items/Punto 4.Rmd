### **4. Graficar todos los grafos conectados con 4 vértices.**

La función `igraph::is_connected` devuelve `TRUE` si un grafo es conectado o `FALSE` si un grafo no lo es. Utilizaremos esta función acompañada de la generación de grafos que utilizamos en el punto anterior para generar todos los grafos conectados de 4 vértices. Teniendo en cuenta que se necesitan al menos 3 vértices para conectar todos los vértices y que sólo hay una forma de conectar los nodos con 6 vértices:

```{r, class.source='fold-show'}
# En general se pueden construir 2** (kC2) grafos
edges = combn(c(1,2,3, 4), 2, simplify = F)                   # Conexiones posibles
grafos = list('three edges' = combn(edges, 3, simplify = F),  # Todas las combinaciones de 3 conexiones posibles
              'four edges' = combn(edges, 4, simplify = F),   # Todas las combinaciones de 4 conexiones posibles
              'five edges' = combn(edges, 5, simplify = F),   # Todas las combinaciones de 5 conexiones posibles
              'six edges' = combn(edges, 6, simplify = F))    # Todas las combinaciones de 6 conexiones posibles

empty = make_empty_graph(n = 4, directed = FALSE)             # Este es un grafo vacío
for (i in names(grafos)){
  lista = list()
  for (j in 1:length(grafos[[i]])){
    grafo = add_edges(graph = empty,                          # Al grafo vacío se le agregan los enlaces o aristas
                      edges = unlist(grafos[[i]][[j]]))
    if (is_connected(grafo)){
      lista[[length(lista) + 1]] = grafo
    }
  }
  grafos[[i]] = lista
}
```


```{r, fig.align='center', fig.width=20, fig.height=20}
par(mfrow = c(6,7), mar = c(1,1,1,1))
for (i in names(grafos)){
  for (j in 1:length(grafos[[i]])){
    set.seed(1305)
    plot(grafos[[i]][[j]],
         edge.arrow.size = 0.1, edge.color = 'black', edge.width = 3,
         vertex.label.color = 'black', vertex.label.cex = 3,
         vertex.color = 'gray', vertex.frame.color = NA, vertex.size = 55)
    # title(main = "Autogenerated graph", cex.main = 2, font = 2)
    # mtext(i, side = 3, line = -1.2, col = 'darkgray', font = 2, cex = 1.3)
  }
}
mtext('All the connected graphs with 4 nodes.', side = 1, line = -1.8, 
      col = adjustcolor('dodgerblue4', alpha = 0.45), font = 2, cex = 2, adj = 0.99, outer = T)
```


Sin embargo, podemos simplemente revisar los isomorfos de 4 vértices que representan grafos conectados utilizando nuevamente una aproximación parecida a la que se utilizó en el punto anterior:

```{r, fig.align='center', fig.width=16, fig.height=8}
for (i in names(grafos)){
  graphs = grafos[[i]]
  if (length(graphs) > 1){
    iso = rep(F, length(graphs))
    for (j in 1:length(graphs)){
      if (!iso[j]){
        flags = unlist(lapply(graphs, function(x) isomorphic(x,graphs[[j]])))
        flags[j] = F
        iso = iso | flags 
      }
    }
    grafos[[i]] = grafos[[i]][!iso]
  }
}

par(mfrow = c(2,3), mar = c(1,1,1,2))
for (i in names(grafos)){
  for (j in 1:length(grafos[[i]])){
    set.seed(1305)
    plot(grafos[[i]][[j]],
         edge.arrow.size = 0.1, edge.color = 'black', edge.width = 2,
         vertex.label.color = 'black', vertex.label.cex = 2.5,
         vertex.color = 'gray', vertex.frame.color = NA, vertex.size = 45)
    # title(main = "Isomorphic graph", cex.main = 2.4, font = 2)
    # mtext(i, side = 3, line = -0.65, col = 'darkgray', font = 2, cex = 1.3)
  }
}
mtext('All the connected graphs with 4 nodes (As isomorphism)', side = 1, line = -1.2, 
      col = adjustcolor('dodgerblue4', alpha = 0.45), font = 2, cex = 1.5, adj = 0.99, outer = T)
```